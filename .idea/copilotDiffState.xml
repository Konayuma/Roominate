<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/roominate/activities/auth/SignUpEmailActivity.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/roominate/activities/auth/SignUpEmailActivity.java" />
              <option name="originalContent" value="package com.roominate.activities.auth;&#10;&#10;import android.content.Intent;&#10;import android.os.Bundle;&#10;import android.text.TextUtils;&#10;import android.util.Patterns;&#10;import android.view.View;&#10;import android.widget.Button;&#10;import android.widget.ImageView;&#10;import android.widget.ProgressBar;&#10;import android.widget.TextView;&#10;import android.widget.Toast;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;import com.google.android.material.textfield.TextInputEditText;&#10;import com.google.android.material.textfield.TextInputLayout;&#10;import com.roominate.R;&#10;import com.roominate.services.SupabaseClient;&#10;import org.json.JSONObject;&#10;&#10;public class SignUpEmailActivity extends AppCompatActivity {&#10;&#10;    private ImageView logoImage;&#10;    private TextView titleText;&#10;    private TextView subtitleText;&#10;    private TextInputLayout emailLayout;&#10;    private TextInputEditText emailEditText;&#10;    private Button continueButton;&#10;    private ProgressBar progressBar;&#10;    private String userRole, firstName, lastName, dob, phone, password;&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;        &#10;        // Hide ActionBar if present&#10;        if (getSupportActionBar() != null) {&#10;            getSupportActionBar().hide();&#10;        }&#10;        &#10;        setContentView(R.layout.activity_signup_email);&#10;&#10;        // Get user role and basic info from previous screen&#10;        userRole = getIntent().getStringExtra(&quot;userRole&quot;);&#10;        firstName = getIntent().getStringExtra(&quot;firstName&quot;);&#10;        lastName = getIntent().getStringExtra(&quot;lastName&quot;);&#10;        dob = getIntent().getStringExtra(&quot;dob&quot;);&#10;        phone = getIntent().getStringExtra(&quot;phone&quot;);&#10;        password = getIntent().getStringExtra(&quot;password&quot;);&#10;&#10;        initializeViews();&#10;        setupListeners();&#10;    }&#10;&#10;    private void initializeViews() {&#10;        logoImage = findViewById(R.id.logoImage);&#10;        titleText = findViewById(R.id.titleText);&#10;        subtitleText = findViewById(R.id.subtitleText);&#10;        emailLayout = findViewById(R.id.emailLayout);&#10;        emailEditText = findViewById(R.id.emailEditText);&#10;        continueButton = findViewById(R.id.continueButton);&#10;        progressBar = findViewById(R.id.progressBar);&#10;    }&#10;&#10;    private void setupListeners() {&#10;        continueButton.setOnClickListener(v -&gt; validateAndContinue());&#10;&#10;        // Real-time validation&#10;        emailEditText.setOnFocusChangeListener((v, hasFocus) -&gt; {&#10;            if (!hasFocus) {&#10;                validateEmail();&#10;            }&#10;        });&#10;    }&#10;&#10;    private boolean validateEmail() {&#10;        String email = emailEditText.getText().toString().trim();&#10;        if (TextUtils.isEmpty(email)) {&#10;            emailLayout.setError(&quot;Email is required&quot;);&#10;            return false;&#10;        } else if (!Patterns.EMAIL_ADDRESS.matcher(email).matches()) {&#10;            emailLayout.setError(&quot;Invalid email address&quot;);&#10;            return false;&#10;        } else {&#10;            emailLayout.setError(null);&#10;            return true;&#10;        }&#10;    }&#10;&#10;    private void validateAndContinue() {&#10;        if (validateEmail()) {&#10;            proceedToVerification();&#10;        }&#10;    }&#10;&#10;    private void proceedToVerification() {&#10;        String email = emailEditText.getText().toString().trim();&#10;&#10;        if (email.isEmpty()) {&#10;            emailEditText.setError(&quot;Email is required&quot;);&#10;            return;&#10;        }&#10;&#10;        if (!isEmailValid(email)) {&#10;            emailEditText.setError(&quot;Please enter a valid email address&quot;);&#10;            return;&#10;        }&#10;&#10;        // Show loading&#10;        progressBar.setVisibility(View.VISIBLE);&#10;        continueButton.setEnabled(false);&#10;&#10;        // Use a dummy password for initial signup - will be updated after confirmation&#10;        String dummyPassword = &quot;TempPass123!&quot;;&#10;&#10;        SupabaseClient.getInstance().signUp(&#10;            firstName != null ? firstName : &quot;&quot;,&#10;            lastName != null ? lastName : &quot;&quot;,&#10;            email,&#10;            phone != null ? phone : &quot;&quot;,&#10;            dummyPassword,&#10;            userRole != null ? userRole : &quot;tenant&quot;,&#10;            new SupabaseClient.ApiCallback() {&#10;                @Override&#10;                public void onSuccess(JSONObject response) {&#10;                    runOnUiThread(() -&gt; {&#10;                        progressBar.setVisibility(View.GONE);&#10;                        continueButton.setEnabled(true);&#10;                        Toast.makeText(SignUpEmailActivity.this,&#10;                            &quot;Confirmation code sent! Please check your email.&quot;, Toast.LENGTH_LONG).show();&#10;&#10;                        Intent intent = new Intent(SignUpEmailActivity.this, EmailConfirmationActivity.class);&#10;                        intent.putExtra(&quot;email&quot;, email);&#10;                        intent.putExtra(&quot;userType&quot;, userRole);&#10;                        intent.putExtra(&quot;firstName&quot;, firstName);&#10;                        intent.putExtra(&quot;lastName&quot;, lastName);&#10;                        intent.putExtra(&quot;phone&quot;, phone);&#10;                        intent.putExtra(&quot;dummyPassword&quot;, dummyPassword);&#10;                        startActivity(intent);&#10;                        finish();&#10;                    });&#10;                }&#10;&#10;                @Override&#10;                public void onError(String error) {&#10;                    runOnUiThread(() -&gt; {&#10;                        progressBar.setVisibility(View.GONE);&#10;                        continueButton.setEnabled(true);&#10;                        Toast.makeText(SignUpEmailActivity.this, &quot;Sign up failed: &quot; + error, Toast.LENGTH_LONG).show();&#10;                    });&#10;                }&#10;            }&#10;        );&#10;    }&#10;&#10;    private boolean isEmailValid(String email) {&#10;        return email.contains(&quot;@&quot;) &amp;&amp; email.contains(&quot;.&quot;);&#10;    }&#10;&#10;    @Override&#10;    public void onBackPressed() {&#10;        super.onBackPressed();&#10;        overridePendingTransition(R.anim.slide_in_left, R.anim.slide_out_right);&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.roominate.activities.auth;&#10;&#10;import android.content.Intent;&#10;import android.os.Bundle;&#10;import android.text.TextUtils;&#10;import android.util.Patterns;&#10;import android.view.View;&#10;import android.widget.Button;&#10;import android.widget.ImageView;&#10;import android.widget.ProgressBar;&#10;import android.widget.TextView;&#10;import android.widget.Toast;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;import com.google.android.material.textfield.TextInputEditText;&#10;import com.google.android.material.textfield.TextInputLayout;&#10;import com.roominate.R;&#10;import com.roominate.services.SupabaseClient;&#10;import org.json.JSONObject;&#10;&#10;public class SignUpEmailActivity extends AppCompatActivity {&#10;&#10;    private ImageView logoImage;&#10;    private TextView titleText;&#10;    private TextView subtitleText;&#10;    private TextInputLayout emailLayout;&#10;    private TextInputEditText emailEditText;&#10;    private Button continueButton;&#10;    private ProgressBar progressBar;&#10;    private String userRole, firstName, lastName, dob, phone, password;&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;        &#10;        // Hide ActionBar if present&#10;        if (getSupportActionBar() != null) {&#10;            getSupportActionBar().hide();&#10;        }&#10;        &#10;        setContentView(R.layout.activity_signup_email);&#10;&#10;        // Get user role and basic info from previous screen&#10;        userRole = getIntent().getStringExtra(&quot;userRole&quot;);&#10;        firstName = getIntent().getStringExtra(&quot;firstName&quot;);&#10;        lastName = getIntent().getStringExtra(&quot;lastName&quot;);&#10;        dob = getIntent().getStringExtra(&quot;dob&quot;);&#10;        phone = getIntent().getStringExtra(&quot;phone&quot;);&#10;        password = getIntent().getStringExtra(&quot;password&quot;);&#10;&#10;        initializeViews();&#10;        setupListeners();&#10;    }&#10;&#10;    private void initializeViews() {&#10;        logoImage = findViewById(R.id.logoImage);&#10;        titleText = findViewById(R.id.titleText);&#10;        subtitleText = findViewById(R.id.subtitleText);&#10;        emailLayout = findViewById(R.id.emailLayout);&#10;        emailEditText = findViewById(R.id.emailEditText);&#10;        continueButton = findViewById(R.id.continueButton);&#10;        progressBar = findViewById(R.id.progressBar);&#10;    }&#10;&#10;    private void setupListeners() {&#10;        continueButton.setOnClickListener(v -&gt; validateAndContinue());&#10;&#10;        // Real-time validation&#10;        emailEditText.setOnFocusChangeListener((v, hasFocus) -&gt; {&#10;            if (!hasFocus) {&#10;                validateEmail();&#10;            }&#10;        });&#10;    }&#10;&#10;    private boolean validateEmail() {&#10;        String email = emailEditText.getText().toString().trim();&#10;        if (TextUtils.isEmpty(email)) {&#10;            emailLayout.setError(&quot;Email is required&quot;);&#10;            return false;&#10;        } else if (!Patterns.EMAIL_ADDRESS.matcher(email).matches()) {&#10;            emailLayout.setError(&quot;Invalid email address&quot;);&#10;            return false;&#10;        } else {&#10;            emailLayout.setError(null);&#10;            return true;&#10;        }&#10;    }&#10;&#10;    private void validateAndContinue() {&#10;        if (validateEmail()) {&#10;            proceedToVerification();&#10;        }&#10;    }&#10;&#10;    private void proceedToVerification() {&#10;        String email = emailEditText.getText().toString().trim();&#10;&#10;        if (email.isEmpty()) {&#10;            emailEditText.setError(&quot;Email is required&quot;);&#10;            return;&#10;        }&#10;&#10;        if (!isEmailValid(email)) {&#10;            emailEditText.setError(&quot;Please enter a valid email address&quot;);&#10;            return;&#10;        }&#10;&#10;        // Show loading&#10;        progressBar.setVisibility(View.VISIBLE);&#10;        continueButton.setEnabled(false);&#10;&#10;        // Use a dummy password for initial signup - will be updated after confirmation&#10;        String dummyPassword = &quot;TempPass123!&quot;;&#10;&#10;        SupabaseClient.getInstance().signUp(&#10;            firstName != null ? firstName : &quot;&quot;,&#10;            lastName != null ? lastName : &quot;&quot;,&#10;            email,&#10;            phone != null ? phone : &quot;&quot;,&#10;            dummyPassword,&#10;            userRole != null ? userRole : &quot;tenant&quot;,&#10;            new SupabaseClient.ApiCallback() {&#10;                @Override&#10;                public void onSuccess(JSONObject response) {&#10;                    runOnUiThread(() -&gt; {&#10;                        progressBar.setVisibility(View.GONE);&#10;                        continueButton.setEnabled(true);&#10;                        Toast.makeText(SignUpEmailActivity.this,&#10;                            &quot;Confirmation code sent! Please check your email.&quot;, Toast.LENGTH_LONG).show();&#10;&#10;                        Intent intent = new Intent(SignUpEmailActivity.this, SignUpEmailVerificationActivity.class);&#10;                        intent.putExtra(&quot;email&quot;, email);&#10;                        intent.putExtra(&quot;userRole&quot;, userRole);&#10;                        intent.putExtra(&quot;firstName&quot;, firstName);&#10;                        intent.putExtra(&quot;lastName&quot;, lastName);&#10;                        intent.putExtra(&quot;phone&quot;, phone);&#10;                        intent.putExtra(&quot;dummyPassword&quot;, dummyPassword);&#10;                        startActivity(intent);&#10;                        finish();&#10;                    });&#10;                }&#10;&#10;                @Override&#10;                public void onError(String error) {&#10;                    runOnUiThread(() -&gt; {&#10;                        progressBar.setVisibility(View.GONE);&#10;                        continueButton.setEnabled(true);&#10;                        Toast.makeText(SignUpEmailActivity.this, &quot;Sign up failed: &quot; + error, Toast.LENGTH_LONG).show();&#10;                    });&#10;                }&#10;            }&#10;        );&#10;    }&#10;&#10;    private boolean isEmailValid(String email) {&#10;        return email.contains(&quot;@&quot;) &amp;&amp; email.contains(&quot;.&quot;);&#10;    }&#10;&#10;    @Override&#10;    public void onBackPressed() {&#10;        super.onBackPressed();&#10;        overridePendingTransition(R.anim.slide_in_left, R.anim.slide_out_right);&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>